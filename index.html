<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Wryan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I am already a demon!">
<meta property="og:type" content="website">
<meta property="og:title" content="Wryan">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Wryan">
<meta property="og:description" content="I am already a demon!">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wryan">
<meta name="twitter:description" content="I am already a demon!">
  
    <link rel="alternative" href="/atom.xml" title="Wryan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://lohas.nicoseiga.jp/thumb/893823i?" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">WayYoung</a></h1>
		</hgroup>

		
		<p class="header-subtitle">I am the one who codes!</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>標籤</li>
						
						<li>友情链接</li>
						
						
						<li>關於</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Bloodborne" title="github">github</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Interview/" style="font-size: 20px;">Interview</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://www.google.com/">G</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">哦列哇刚大木！</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">WayYoung</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://lohas.nicoseiga.jp/thumb/893823i?" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">WayYoung</h1>
			</hgroup>
			
			<p class="header-subtitle">I am the one who codes!</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Bloodborne" title="github">github</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-iOS后台模式的发展史" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/29/iOS后台模式的发展史/" class="article-date">
  	<time datetime="2016-03-29T15:27:31.000Z" itemprop="datePublished">2016-03-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/29/iOS后台模式的发展史/">iOS后台模式的发展史</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>以下内容来自度娘  </p>
<blockquote>
<p>第一代iPhone 除了支持Google Earth和Youtube外这两个第三方APP外，还不支持第三方APP，随后第二代iPhone 3G发布时，苹果发布了iPhone OS 2.0系统，提供了APP Store应用软件商店，此时可以安装第三方软件了，这时第三方软件获取消息的方式为无后台仅推送。iPhone OS 3.0则为开发者提供了更多的API（应用程序接口），可让开发者开发功能更强的应用程序，但此时的iPhone OS还不支持第三方软件常驻后台，而且软件越来越多，从一个软件切换到另一个软件也麻烦。所以苹果推出了iOS 4.0（iPhone OS 正式更名iOS），实现第三方程序常驻后台，支持第三方软件墓碑式(假后台)，只为方便切换，这也是让广大喷子喷到今天的 “第三方软件假后台”！  </p>
<p>既iOS 4带来了第三方软件假后台后，iOS 5又多了2种第三方软件后台模式，达到了4种。<br>1、无后台仅推送（iPhone OS 1.0/ iPhone OS 2.0/ iPhone OS 3.0）<br>2、墓碑式(假后台)(iOS 4.0)<br>3、智能调度后台(定时启动更新，像新闻APPS，更新完数据就进入墓碑式)(iOS 5.0/iOS 5.0+)<br>4、真后台(iOS 5.0/iOS 5.0+)  </p>
<p>到今天，iOS 支持的第三方软件后台调用的API有这些：<br>1、Background Audio，这是后台的音频，很早之前便有，也是iOS设备中用得最多的后台应用，调用这个接口可以实现后台的音乐播放。<br>2、Location Services，这是后台的定位，系统会拥有统一页面进行管理。<br>3、VoIP，后台语音服务，类似Skype通话应用需要调用，可进行后台的语音通话。<br>4、Newsstand，报刊杂志后台自动下载更新，其能够自动实时更新。<br>5、Background Task Completion，这个接口早在iOS 4时候便拥有，其可以供任意类型的APP使用，不过在旧系统中，这个接口的后台限制运行时间仅为10分钟，意味着当应用退至后台，其后台运行仅能持续10分钟便会转至休眠状态。iOS 7中对这个接口作出了改变，原来的为连续10分钟，即不论你这10分钟内用户是否关闭屏幕进入休眠状态，应用仍然会在后台等待10分钟完结后推出。  </p>
<ol>
<li>Remote Notification(IOS7)，以往聊天类应用接受推送后点进去需要再收一次信息，这情况在QQ、微信等应用上最为明显。不过拥有了这个接口后，这情况将不复存在，以后推送将能够直接启动后台任务。值得注意的是remote notification支持silent notification（静默推送），这样dropbox这类同步应用可以在后台以最节能的模式实时静默同步了，类似布卡漫画这种也可以推送正在追的漫画的新章节并在后台静默下载，待到下载好再给用户发送一个本地推送，用户点开即看无需再联网。  </li>
<li>Background Transfer Service，后台上传下载。iOS最接近传统多任务的后台接口，可供任意类型的app调用，无时间限制。应用场景包括后台上传和下载数据，这使得游戏后台更新数据包，后台上传视频等等都成为可能，但是正如其名字，它只能用于处理上传下载这种传输类的任务，类似后台剪切板监控这种它就无能为力了。  </li>
</ol>
</blockquote>
<hr>
<blockquote>
<p>ios7前的一般程序多任务处理：<img src="http://imgsrc.baidu.com/forum/w%3D580/sign=76f5eaddc1cec3fd8b3ea77de689d4b6/2dec3a30e924b89966e66e296c061d950b7bf619.jpg" alt="beforeiOS7"><br>可以看到，应用其实有十分钟后台的权利<br>除此之外还有两种所谓的伪后台，一种是系统推送机制，另一种是墓碑式后台（在关闭程序时保存现场，下次启动时还原，给人一种后台的假象）<br>ios7之后（一个app可以混合调用多种模式）：<img src="http://imgsrc.baidu.com/forum/w%3D580/sign=181be1efc1fdfc03e578e3b0e43e87a9/1ae4cc24b899a9019cef4c271f950a7b0308f519.jpg" alt="afteriOS7"><br><br><br>Background Audio，VoIP属于不后台会死的类型；Location Services是地点服务，系统统一管理；Newsstand是苹果自家应用，定时更新。这些都是早就有，没变化。<br><br><br>Background Task Completion<br>ios4中开始加入的限时后台，允许应用连续后台十分钟，ios7改为允许在开屏下运行十分钟，关屏会暂停，直到开屏后重启继续凑足十分种。<br><br><br>Background Fetch<br>ios7新增，在系统认为合适的时候激活应用，具体什么时候合适，开发者不可知，使用者不可控，由系统智能判断，适合获取及时性不强的信息<br>这个智能体现在系统会根据用户启动应用的频率和时间以及当前的网络和电量情况来分配每个应用的获取频率和时间，数据刷新是统一的，即系统可以在一个进程内获取多个应用所需的数据而不是一个应用一个进程（类似统一的推送机制，都是为了省电）<br>统一刷新这方面有点类似小米说的对齐唤醒和Deep Sleep Battery Saver，不同应用后台唤醒时刻不同会导致cpu无法进入deep sleep，某些Android用户会发现自己的手机一夜掉电超多，其实就是某些糟糕的app让cpu没睡好：-）<br><br><br>Remote Notification<br>ios7新增，由统一推送通知激活后台，支持silent notification，适合实时类强的应用，有频率限制（每小时几次）<br><br><br>Background Transfer Service<br>ios7新增，可以由应用直接激活的无限制后台，权限大，但是只限于下载上传类服务，只会在 WiFi 环境下才进行传输<br>需要特别注意的是：应用被Background Fetch、Remote Notification、Background Transfer Service三类唤醒时，只被给予几秒钟时间来处理更新。  </p>
</blockquote>
<p>总结一下：iOS从来都是有限制的后台，iOS7开放了部分机制。说真假后台毫无意义，必须具体问题具体讨论。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Interview/">Interview</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-真后台vs假后台" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/29/真后台vs假后台/" class="article-date">
  	<time datetime="2016-03-29T15:25:12.000Z" itemprop="datePublished">2016-03-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/29/真后台vs假后台/">真后台vs假后台</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在quora上查到这么一个问题</p>
<p><a href="/What are the differences between Android and iOS in multitasking?">What are the differences between Android and iOS in multitasking?</a>  </p>
<p>其中一个回答:</p>
<blockquote>
<p>The multitasking implementation on Android allows any program to run in the background, for as long as it wants.  An application can run as a service, completely in the background.  An application can run at startup, on a schedule, based on events, or continue running after started by the user.  While running in the background, an Android app can do anything it has been given permission to do.</p>
<p>iOS does not allow true multitasking for third party apps.  iOS only allows certain APIs to run in the background, such as audio streaming and push notifications.  An app stops running the instant the user switches to another app.  Apple gives their own apps multitasking abilities that other apps are not allowed to use, which can cause confusion on this topic.</p>
<p>iOS’ strict control of multitasking this has a couple of benefits.  First, battery life is greatly improved, because apps aren’t running in the background, and because app creators often have to run functionality in a server and utilize push notifications from that server for functionality that might have been easier to implement in the mobile app.  Secondly, interactive user interfaces are never impacted by apps running in the background, leading to the superior smoothness of iOS.</p>
</blockquote>
<p>安卓是真后台，所有程序都能在后台运行任意长的时间，做任何事情。<br>iOS没有真正允许第三方的app进行多任务，只允许特定的api在后台运行，例如音频流和推送通知。用户从一个app切换到另外一个app的时候，之前的那个app会马上停止运行。iOS这样严格控制多任务的好处有：  </p>
<ol>
<li>极大提高电池寿命，因为apps没有在后台一直运行;  </li>
<li>UI交互不会受到在后台运行的apps的影响，因此系统如丝滑般顺畅。  </li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Interview/">Interview</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-面试时被问到的问题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/29/面试时被问到的问题/" class="article-date">
  	<time datetime="2016-03-29T07:45:08.000Z" itemprop="datePublished">2016-03-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/29/面试时被问到的问题/">面试时被问到的问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>很糟糕的面试，被问得无言以对，一无所知的样子…记录下面试过程中被问到的问题  </p>
<ol>
<li><strong> 如何优化TableView </strong><br><em>我很愚蠢的回答我这app有30fps，基本流畅了…经典的优化圆角生成居然没说出来…</em>  </li>
<li><strong> UIView 与 CoreAnimation、CALayer 的区别 </strong><br><em>答:特别炫酷的动画效果UIView做不出来，要用CoreAnimation。经过重重引导才说出还有效率问题。道理我都懂，就是没有说出来…</em>  </li>
<li><strong> 说一说 iOS 的多线程机制 </strong><br><em>简单说了下GCD，同步异步的意思…</em>  </li>
<li><strong> 线程和进程的区别 </strong><br><em>这个还是懂的</em>  </li>
<li><strong> 说一说进程有哪些状态 </strong><br><em>憋了半天才吐出一个阻塞态…什么 初始态、就绪态、执行态、等待态、终止态 全忘光了 T_T</em>  </li>
<li><strong> iOS 进程生命周期有哪些状态 </strong><br><em>我提到了按Home键进入后代状态</em>  </li>
<li><strong> 一个游戏进入后台，然后又开了很多应用，这时该游戏处于什么状态？酷狗这类音乐App进入后台后又是什么状态？ </strong><br><em>excuse me…？</em>  </li>
<li><strong> 假后台和真后台的区别 </strong><br><em>……</em>  </li>
<li><strong> 打开多任务管理器时App处于什么状态 </strong><br><em>orz</em>  </li>
<li><strong> 有想过百度地图里面的地图是如何实现的吗？ </strong><br><em>UIImageView?UIScrollView?UIWebView?然后他说出瓷砖，我诧异“瓷砖？”。之后才恍然大悟CATiledLayer…</em>  </li>
<li><strong> 有研究过第三方库的源码吗？</strong><br><em>没有…</em>  </li>
<li><strong> 为什么选择iOS开发？ </strong><br><em>随便说了下由前辈推荐…</em>  </li>
<li><strong> 自己的优点和缺点 </strong><br><em>这个情况实在不好意思说优点…所以先说了自己对iOS系统机制理解得不够透彻，没有全面的熟悉iOS这个环境…</em>  </li>
</ol>
<p>知其然而不知其所以然，之前好多东西都是浅尝则止导致对一些知识没有完全理解…这个毛病一定要改…</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Interview/">Interview</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-隐藏UITabBarController子Controller的TabBar" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/27/隐藏UITabBarController子Controller的TabBar/" class="article-date">
  	<time datetime="2016-01-27T07:55:40.000Z" itemprop="datePublished">2016-01-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/27/隐藏UITabBarController子Controller的TabBar/">隐藏UITabBarController子Controller的TabBar</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp;&emsp;以为直接在SB中勾上”hide bottom bar on push”就能隐藏tab bar…的确是能隐藏，但是仍然是placeHolder占据了空间…<br>&emsp;&emsp;花费了一段时间，才发觉是autoLayout的约束设置不正确.在 <a href="http://stackoverflow.com/questions/28724255/auto-layout-and-hide-bottom-bar-when-pushed" target="_blank" rel="external">http://stackoverflow.com/questions/28724255/auto-layout-and-hide-bottom-bar-when-pushed</a> 找到了正确的设置方式.<br>&emsp;&emsp;还有一个大坑!”hide bottom bar on push”要和”under bottom bars”搭配食用！<br><img src="http://7xq2i8.com1.z0.glb.clouddn.com/Blog1.png" alt="坑"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-为Label中的关键字添加链接" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/16/为Label中的关键字添加链接/" class="article-date">
  	<time datetime="2016-01-16T10:32:41.000Z" itemprop="datePublished">2016-01-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/16/为Label中的关键字添加链接/">为Label中的关键字添加链接</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp;&emsp;被这个问题虐了好几天了…google、stackoverflow 里的结果不是很满意，起初尝试的方法是在UITapGestureRecognizer添加方法检测点击的坐标是否落在指定的NSRange区域里</p>
<blockquote>
<p>I found it most convenient and straightforward to add support for tap-able UILabel text as a category to UITapGestureRecognizer. (You don’t have to use UITextView’s data detectors, as some answers suggest.)<br>Add the following method to your UITapGestureRecognizer category:  </p>
</blockquote>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Returns YES if the tap gesture was within the specified range of the attributed text of the label.  </span></span><br><span class="line">- (<span class="built_in">BOOL</span>)didTapAttributedTextInLabel:(<span class="built_in">UILabel</span> *)label inRange:(<span class="built_in">NSRange</span>)targetRange </span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSParameterAssert</span>(label != <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGSize</span> labelSize = label<span class="variable">.bounds</span><span class="variable">.size</span>;</span><br><span class="line">    <span class="comment">// create instances of NSLayoutManager, NSTextContainer and NSTextStorage</span></span><br><span class="line">    <span class="built_in">NSLayoutManager</span> *layoutManager = [[<span class="built_in">NSLayoutManager</span> alloc] init];</span><br><span class="line">    <span class="built_in">NSTextContainer</span> *textContainer = [[<span class="built_in">NSTextContainer</span> alloc] initWithSize:<span class="built_in">CGSizeZero</span>];</span><br><span class="line">    <span class="built_in">NSTextStorage</span> *textStorage = [[<span class="built_in">NSTextStorage</span> alloc] initWithAttributedString:label<span class="variable">.attributedText</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// configure layoutManager and textStorage</span></span><br><span class="line">    [layoutManager addTextContainer:textContainer];</span><br><span class="line">    [textStorage addLayoutManager:layoutManager];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// configure textContainer for the label</span></span><br><span class="line">    textContainer<span class="variable">.lineFragmentPadding</span> = <span class="number">0.0</span>;</span><br><span class="line">    textContainer<span class="variable">.lineBreakMode</span> = label<span class="variable">.lineBreakMode</span>;</span><br><span class="line">    textContainer<span class="variable">.maximumNumberOfLines</span> = label<span class="variable">.numberOfLines</span>;</span><br><span class="line">    textContainer<span class="variable">.size</span> = labelSize;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// find the tapped character location and compare it to the specified range</span></span><br><span class="line">    <span class="built_in">CGPoint</span> locationOfTouchInLabel = [<span class="keyword">self</span> locationInView:label];</span><br><span class="line">    <span class="built_in">CGRect</span> textBoundingBox = [layoutManager usedRectForTextContainer:textContainer];</span><br><span class="line">    <span class="built_in">CGPoint</span> textContainerOffset = <span class="built_in">CGPointMake</span>((labelSize<span class="variable">.width</span> - textBoundingBox<span class="variable">.size</span><span class="variable">.width</span>) * <span class="number">0.5</span> - textBoundingBox<span class="variable">.origin</span><span class="variable">.x</span>,</span><br><span class="line">                                              (labelSize<span class="variable">.height</span> - textBoundingBox<span class="variable">.size</span><span class="variable">.height</span>) * <span class="number">0.5</span> - textBoundingBox<span class="variable">.origin</span><span class="variable">.y</span>);</span><br><span class="line">    <span class="built_in">CGPoint</span> locationOfTouchInTextContainer = <span class="built_in">CGPointMake</span>(locationOfTouchInLabel<span class="variable">.x</span> - textContainerOffset<span class="variable">.x</span>,</span><br><span class="line">                                                         locationOfTouchInLabel<span class="variable">.y</span> - textContainerOffset<span class="variable">.y</span>);</span><br><span class="line">    <span class="built_in">NSInteger</span> indexOfCharacter = [layoutManager characterIndexForPoint:locationOfTouchInTextContainer</span><br><span class="line">                                                            inTextContainer:textContainer</span><br><span class="line">                                   fractionOfDistanceBetweenInsertionPoints:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">NSLocationInRange</span>(indexOfCharacter, targetRange)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;但是这种方法检测到点击的坐标很不准确，不知道为什么，但是之后用的第三方库也是用到以上的方法…<br>&emsp;&emsp;折腾无果，尝试使用YYLabel，但是YYLabel居然直接继承UIView而不是UILabel…虽然在SB里可以用，但是YYLabel并没有实现intrinsicContentSize，不能 AutoLayout ，放弃…<br>&emsp;&emsp;最后是用FRHyperLabel解决需求…其中也遇到了大坑…  </p>
<p>github项目主页上写道：</p>
<blockquote>
<p>FRHyperLabel seems not working correctly when texts are wrapped to multiple lines automatically. I haven’t found out a proper way to solve it.  </p>
<p>However, there is a work around to make everything work: try to include an explicit font setting in the attributes of the initial NSAttributedString  </p>
</blockquote>
<p>下面是错误写法…最后一行不应该…<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableAttributedString</span> *text = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:content];  </span><br><span class="line">[label setLinksForSubstrings:@[keyword] withLinkHandler:handler];  </span><br><span class="line">[label setAttributedText:text];</span><br></pre></td></tr></table></figure></p>
<p>除此之外，在真机上测试，结果简直令人大只一惊…显示时间的Label凭空消失，显示评论的ContainerViewController极难加载出来…holy crap…</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 WayYoung
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>




    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>